<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VAN Protocol Quiz</title>
  <style>
    :root{
      --bg:#0f0f14; --panel:#171722; --card:#1f1f2b; --border:#2a2a3a;
      --red:#ff3b3b; --text:#f1f1f6; --muted:#b8b8c6;
      --good:#2ee58f; --bad:#ff3b3b;
      --btn:#ff3b3b; --btnHover:#b40000; --btnText:#0f0f14;
      --shadow:0 8px 24px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:var(--bg); color:var(--red); min-height:100vh; display:flex; flex-direction:column;
    }
    .container{
      width:min(980px, 96vw); margin:18px auto 0 auto; background:var(--panel);
      border:1px solid var(--border); border-radius:14px; padding:18px 16px 0 16px;
      box-shadow:var(--shadow); min-height:78vh;
    }
    .date{display:block; color:var(--muted); font-size:.95rem; margin-bottom:8px;}
    h1{margin:8px 0 10px 0; text-align:center; color:var(--red); letter-spacing:-.5px;}
    .subheading{ text-align:center; color:var(--text); opacity:.95; margin:0 0 14px 0; line-height:1.35;}
    .tabbar{display:flex; gap:8px; flex-wrap:wrap; margin:10px 0 14px 0; border-bottom:2px solid var(--border); padding-bottom:10px;}
    .tab-btn{
      background:transparent; border:1px solid var(--border); color:var(--text);
      padding:9px 12px; border-radius:10px; cursor:pointer; font-weight:650;
    }
    .tab-btn.active{border-color:var(--red); color:var(--red);}
    .tab-btn:disabled{
      opacity:.45; cursor:not-allowed; border-color:var(--border); color:var(--muted);
    }
    .question-block{
      background:var(--card); border:1px solid var(--border); border-radius:14px;
      padding:16px 14px; margin:12px 0 14px 0; box-shadow:0 6px 18px rgba(0,0,0,.25);
    }
    .question-title{color:var(--text); margin-bottom:12px; line-height:1.35;}
    .choices label{
      display:block; border:1px solid var(--border); background:#151521; color:var(--text);
      padding:10px 12px; border-radius:12px; margin-bottom:10px; cursor:pointer;
    }
    .choices label.selected{border-color:var(--red); color:var(--red); background:#11111a;}
    .choices input[type="radio"]{display:none}
    .navigation{display:flex; gap:10px; justify-content:space-between; align-items:center; margin:12px 0 18px 0;}
    button{
      background:var(--btn); color:var(--btnText); border:none; border-radius:12px;
      padding:10px 14px; font-weight:750; cursor:pointer;
    }
    button:hover{background:var(--btnHover); color:#fff}
    button:disabled{background:#3a3a47; color:#9b9bb0; cursor:not-allowed;}
    .result,.panel{
      background:var(--card); border:1px solid var(--border); border-left:4px solid var(--red);
      border-radius:12px; padding:14px 14px; margin:10px 0 14px 0; color:var(--text);
    }
    .good{color:var(--good); font-weight:800}
    .bad{color:var(--bad); font-weight:800}
    .muted{color:var(--muted)}
    .list{margin:10px 0 0 0; padding-left:20px;}
    .list li{margin:8px 0; color:var(--text); line-height:1.35;}
    .row-actions{display:flex; gap:10px; flex-wrap:wrap; margin-top:12px;}
    input[type="text"]{
      width:100%; padding:10px 12px; border-radius:12px; border:1px solid var(--border);
      background:#101018; color:var(--text); outline:none;
    }
    footer{margin-top:auto; text-align:center; padding:14px 10px; color:var(--muted); background:transparent; font-size:.95rem;}
    @media (max-width:600px){
      .container{padding:14px 10px 0 10px}
      .tab-btn{width:100%}
    }
  </style>
</head>

<body>
  <div class="container">
    <span class="date">Date: <b>2026-02-03</b></span>

    <div id="errorArea"></div>
    <div id="welcomeArea"></div>

    <h1 id="quizTitle" style="display:none;">VAN Protocol Quiz</h1>
    <div class="subheading" id="subtitle" style="display:none;">
      Challenge yourself with 35 multiple-choice questions about scam, misrepresentation, and spam in Meta's UFAC GTM protocols (VAN - Violating Actor Networks).
      <br><b>80% correct required to PASS.</b>
    </div>

    <div class="tabbar" id="tabbar" style="display:none;">
      <button class="tab-btn active" id="tabQuiz" onclick="gotoTab('quiz')">Quiz</button>
      <button class="tab-btn" id="tabResult" onclick="gotoTab('result')">Results</button>
      <button class="tab-btn" id="tabAnswers" onclick="gotoTab('answers')" disabled>Correct Answers</button>
      <button class="tab-btn" id="tabLeaderboard" onclick="gotoTab('leaderboard')">Leaderboard</button>
    </div>

    <div id="quizArea" style="display:none;"></div>

    <div class="navigation" id="navArea" style="display:none;">
      <button id="prevBtn" onclick="prevQuestion()" disabled>Previous</button>
      <button id="nextBtn" onclick="nextQuestion()">Next</button>
      <button id="submitBtn" onclick="submitQuiz()" style="display:none;">Submit</button>
    </div>

    <div id="resultArea" style="display:none;"></div>
    <div id="answersArea" style="display:none;"></div>
    <div id="leaderboardArea" style="display:none;"></div>
  </div>

  <footer>GTM Protocols Quiz — Date: 2026-02-03</footer>

  <script>
    const DATE_STR = "2026-02-03";
    const STORAGE_KEY = "van_quiz_leaderboard_v1";

    // IMPORTANT: this was missing in your version, causing blank screen
    function byId(id){ return document.getElementById(id); }

    function esc(s){
      return String(s).replace(/[&<>"']/g, c => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
      }[c]));
    }

    function showFatal(err){
      const el = byId("errorArea");
      el.innerHTML = `
        <div class="panel">
          <div class="bad" style="font-weight:900;margin-bottom:6px;">Error</div>
          <div class="muted">Open DevTools → Console for details.</div>
          <pre style="white-space:pre-wrap;color:var(--text);margin-top:10px;">${esc(err && err.stack ? err.stack : String(err))}</pre>
        </div>
      `;
    }

    let userName = "";
    let currentQuestion = 0;
    let userAnswers = [];
    let hasSubmitted = false;
    let lastScore = 0;

    const questions = [
      { question:"Which combination of signals is typically required to consider a network as “strongly connected” in a VAN investigation?",
        choices:["A) 1 strong signal and 1 medium signal","B) 2 strong signals","C) 1 strong and 2 medium signals","D) Either B or C"], answer:3 },
      { question:"What is the primary purpose of the Violating Actor Network (VAN) protocol?",
        choices:["A) To identify compromised accounts","B) To prevent actors and networks from using multiple entities to carry out harmful behavior or evade enforcement","C) To detect spam content","D) To monitor ad performance"], answer:1 },
      { question:"Which of the following is NOT considered a strong asset signal in VAN investigations?",
        choices:["A) Shared DATR and password","B) Shared confirmed contact details","C) Shared imported contacts","D) Shared devices/IP/ASN"], answer:2 },
      { question:"If two entities share the same device cookie (DATR) and have posted the same photos, what does this indicate?",
        choices:["A) They are likely unrelated","B) They are strongly connected","C) They are weakly connected","D) They are false positives"], answer:1 },
      { question:"What is the role of “Expert Review” in the VAN decision process?",
        choices:["A) To automate enforcement decisions","B) To holistically review all signals and account activity before deciding on VAN violation","C) To escalate cases to legal","D) To only review active entities"], answer:1 },
      { question:"Which of the following could be a false positive signal in a VAN investigation?",
        choices:["A) Shared device-linked accounts accessed at an Internet Café","B) Shared DATR and password","C) Shared confirmed contact details","D) Shared group membership"], answer:0 },
      { question:"What does SUMA stand for in the context of VAN investigations?",
        choices:["A) Single User Multiple Accounts","B) Shared User Multiple Assets","C) Suspicious User Multiple Activities","D) Strong User Multiple Accounts"], answer:0 },
      { question:"Which signal category provides information about the intended audience that assets in a network are trying to engage with?",
        choices:["A) Assets","B) Behavior","C) Target","D) False Positives"], answer:2 },
      { question:"In the context of VAN, what is a “Seed Entity”?",
        choices:["A) The entity with the most violations","B) The starting point of VAN investigations, compared to linked entities","C) The entity with the most friends","D) The entity with the highest SUMA score"], answer:1 },
      { question:"Why is it important to consider both active and inactive entities during a VAN review?",
        choices:["A) Inactive entities are always benign","B) Actors/networks often hold backup accounts/entities to use in case of enforcement","C) Only active entities can violate policies","D) Inactive entities cannot be linked to violations"], answer:1 },

      { question:"Which action is most likely to indicate scam behavior in a VAN network under Meta’s UFAC GTM protocol?",
        choices:["A) Regular posts promoting social gatherings","B) Coordinated accounts pushing misleading investment opportunities","C) Sharing memes in private groups","D) Pages with accurate business contact details"], answer:1 },
      { question:"What is a common tactic used by scam networks to evade detection on Meta platforms?",
        choices:["A) Use of public verified accounts only","B) Rotating asset ownership among multiple entities","C) Posting entirely unlinked content","D) Avoiding all group interactions"], answer:1 },
      { question:"The use of lookalike pages with nearly identical names and branding can most likely indicate:",
        choices:["A) A legitimate business expansion","B) Scam intent to confuse and defraud users","C) Official fan pages","D) No violation at all"], answer:1 },
      { question:"Scam networks often use messaging features in which way to violate Meta’s protocols?",
        choices:["A) Only for customer service requests","B) Mass messaging to solicit money or personal info","C) Messenger bots for FAQ","D) Announcing local events"], answer:1 },
      { question:"On Meta, which VAN signal would be especially important if two entities coordinate to redirect users to external sites selling fraudulent goods?",
        choices:["A) Shared device cookies only","B) Cross-entity posting and shared tracking pixels","C) Having similar profile pictures","D) No signals needed"], answer:1 },
      { question:"When investigating a suspected scam group, which false positive must be carefully excluded?",
        choices:["A) High posting frequency on legitimate business pages","B) Same IP address for multiple family member accounts","C) Coordinated content sharing about charity drives","D) Verified payment tokens"], answer:1 },
      { question:"What assets are commonly manipulated by scam VANs on Meta?",
        choices:["A) Likes and comments only","B) Ads, payment tokens, linked WhatsApp/Instagram accounts","C) Page theme colors","D) Random hashtags"], answer:1 },
      { question:"A key behavioral signal that flags a scam network is:",
        choices:["A) Ongoing, authentic user engagement","B) Identical scripts sent by many accounts to new contacts","C) Non-overlapping industries","D) Regular sponsored posts"], answer:1 },
      { question:"When reviewing payment flows in a suspected VAN scam, which is most suspicious?",
        choices:["A) Verified bank accounts only used for salaries","B) Sudden shifts in payout recipients tightly linked to entity changes","C) Transparent invoices to known businesses","D) Normal subscription processing"], answer:1 },
      { question:"Scam actors attempt to exploit which Meta feature for quick victim acquisition?",
        choices:["A) Meta’s encrypted data transfer","B) Automated page creation with third-party bots","C) Long-form blog posting","D) FB Marketplace official sale flow"], answer:1 },

      { question:"Under Meta UFAC GTM, which conduct characterizes misrepresentation within a VAN context?",
        choices:["A) Editing public posts for grammar errors","B) Operating multiple entities claiming false or inconsistent business identities","C) Regular admin handovers with documentation","D) Posting in several time zones"], answer:1 },
      { question:"What False Positive should be taken into account when assessing misrepresentation violations?",
        choices:["A) Accounts run by two business partners with shared permission","B) Change of admin due to business acquisition","C) Entities declaring actual physical office addresses","D) Use of official support channels"], answer:1 },
      { question:"Which of the following methods do misrepresenting networks use to gain trust?",
        choices:["A) Transparent policy info on pages","B) Impersonating established brands or public figures","C) Verified phone numbers","D) Frequent two-factor authentication"], answer:1 },
      { question:"A significant signal for misrepresentation in a VAN is:",
        choices:["A) Legitimate testimonials posted publicly","B) Recurring changes in name/contact info without validation","C) Seasonally themed marketing","D) Routine policy review"], answer:1 },
      { question:"How should Meta teams proceed before enforcement for misrepresentation under VAN?",
        choices:["A) Automate bans based on reported posts only","B) Conduct expert review of all signals and substantiate discrepancies","C) Only enforce on pages with low engagement","D) Accept user reports without investigation"], answer:1 },

      { question:"Which behavior in a VAN network best fits Meta’s definition of spam?",
        choices:["A) Occasional event posting","B) Large-scale posting of repetitive content with little variation to wide audiences","C) Monthly business updates","D) Responding to comments promptly"], answer:1 },
      { question:"When detecting spam signals, why should shared device assets be scrutinized?",
        choices:["A) Most spam actors avoid device sharing","B) Device sharing can indicate automation for mass distribution","C) Only usage patterns matter","D) No relevance for assets"], answer:1 },
      { question:"What does Meta classify as 'network-level spam' in the VAN context?",
        choices:["A) Multiple authentic users discussing trending topics","B) Groups of interconnected accounts posting promotional links repeatedly","C) Posting official news articles","D) Private event invites"], answer:1 },
      { question:"Spam networks may exploit which Meta product most frequently for propagation?",
        choices:["A) FB Marketplace reviews","B) Messenger and WhatsApp broadcast lists","C) Meta Blueprint training","D) Meta Business Suite reporting"], answer:1 },
      { question:"Why is it important to analyze posting speeds in suspected spam VANs?",
        choices:["A) Spam often involves coordinated, automated posting at high speed","B) Slow posting rates are always suspicious","C) Official partners post rapidly","D) Meta disables slow posters"], answer:0 },

      { question:"Which type of asset manipulation is central to scam VAN networks on Meta platforms?",
        choices:["A) Schedule content calendars","B) Falsified payment details and ad targeting","C) Linking legitimate business pages","D) None of the above"], answer:1 },
      { question:"How do scam actors most commonly avoid enforcement after detection?",
        choices:["A) By immediately shutting all accounts","B) By shifting ownership and access to new entities with historical ties","C) By providing full business verification","D) By disabling all assets"], answer:1 },
      { question:"Which is a weak signal of potential scam, requiring further corroboration before enforcement?",
        choices:["A) Shared geographic location","B) Coincidental login times with unrelated activity","C) Device access from the same city park","D) All of the above"], answer:3 },
      { question:"Which additional review is needed before tagging coordinated lending offers as a scam VAN?",
        choices:["A) Confirm cross-platform links (WhatsApp/Instagram) and payment flows","B) Only check public profiles","C) Enforce based on external site only","D) Ignore signals from Messenger"], answer:0 },
      { question:"An entity posting links to 'instant loans' under multiple page identities most likely indicates:",
        choices:["A) Coordinated scam behavior","B) Regulatory compliance","C) Normal business practice","D) High organic reach"], answer:0 }
    ];

    function loadBoard(){
      try { return JSON.parse(localStorage.getItem(STORAGE_KEY) || "{}"); }
      catch { return {}; }
    }
    function saveBoard(board){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(board));
    }
    let leaderboard = loadBoard();

    function computeSortedBoard(){
      const rows = Object.entries(leaderboard).map(([name,v]) => ({
        name,
        best:Number(v.best||0),
        last:Number(v.last||0),
        attempts:Number(v.attempts||0),
        oldRank:Number(v.rank||0),
        delta:Number(v.delta||0),
      }));

      rows.sort((a,b)=>
        (b.best-a.best) || (b.last-a.last) || (a.attempts-b.attempts) || a.name.localeCompare(b.name)
      );

      rows.forEach((r,i)=>{
        r.newRank=i+1;
        r.rankMove = r.oldRank ? (r.oldRank - r.newRank) : 0;
      });

      return rows;
    }

    function updateTabAvailability(){
      byId("tabAnswers").disabled = !hasSubmitted;
    }

    function setActiveTab(tab){
      ["tabQuiz","tabResult","tabAnswers","tabLeaderboard"].forEach(id=>byId(id).classList.remove("active"));
      const map={quiz:"tabQuiz",result:"tabResult",answers:"tabAnswers",leaderboard:"tabLeaderboard"};
      byId(map[tab]).classList.add("active");
    }

    function hideAllAreas(){
      ["quizArea","navArea","resultArea","answersArea","leaderboardArea"].forEach(id=>byId(id).style.display="none");
    }

    function gotoTab(tab){
      if(tab === "answers" && !hasSubmitted) tab = "quiz";

      hideAllAreas();
      setActiveTab(tab);

      if(tab==="quiz"){
        byId("quizArea").style.display="";
        byId("navArea").style.display="";
        renderQuestion();
      } else if(tab==="result"){
        byId("resultArea").style.display="";
        renderResults();
      } else if(tab==="answers"){
        byId("answersArea").style.display="";
        renderCorrectAnswers();
      } else if(tab==="leaderboard"){
        byId("leaderboardArea").style.display="";
        renderLeaderboard();
      }
    }
    window.gotoTab = gotoTab;

    function renderWelcome(){
      byId("tabbar").style.display="none";
      byId("quizTitle").style.display="none";
      byId("subtitle").style.display="none";
      hideAllAreas();

      byId("welcomeArea").innerHTML = `
        <div class="panel">
          <h1 style="margin-top:0;">Welcome</h1>
          <div class="muted" style="margin-bottom:12px;">Enter your name to begin.</div>
          <form id="welcomeForm" autocomplete="off">
            <input id="userNameInput" type="text" maxlength="40" placeholder="Your name..." />
            <div id="welcomeError" class="bad" style="display:none;margin-top:10px;"></div>
            <div class="row-actions">
              <button type="submit">Continue</button>
            </div>
          </form>
        </div>
      `;

      byId("welcomeForm").onsubmit = (e)=>{
        e.preventDefault();
        const val = (byId("userNameInput").value || "").trim();
        if(!val){
          byId("welcomeError").textContent = "Please enter your name to continue.";
          byId("welcomeError").style.display = "block";
          return;
        }
        userName = val;
        startQuiz();
      };

      updateTabAvailability();
    }

    function startQuiz(){
      byId("welcomeArea").innerHTML = "";
      byId("quizTitle").style.display = "";
      byId("subtitle").style.display = "";
      byId("tabbar").style.display = "";

      currentQuestion = 0;
      userAnswers = Array(questions.length).fill(null);
      hasSubmitted = false;
      lastScore = 0;

      updateTabAvailability();
      gotoTab("quiz");
    }

    function renderQuestion(){
      const q = questions[currentQuestion];
      const choicesHtml = q.choices.map((choice,idx)=>{
        const selected = userAnswers[currentQuestion] === idx;
        return `
          <label class="${selected ? "selected" : ""}">
            <input type="radio" name="choice" value="${idx}" ${selected ? "checked" : ""} onclick="selectAnswer(${idx})">
            ${esc(choice)}
          </label>
        `;
      }).join("");

      byId("quizArea").innerHTML = `
        <div class="question-block">
          <div class="question-title">
            <b>Question ${currentQuestion+1} of ${questions.length}:</b><br>
            ${esc(q.question)}
          </div>
          <div class="choices">${choicesHtml}</div>
        </div>
      `;

      byId("prevBtn").disabled = currentQuestion === 0;
      byId("nextBtn").disabled = currentQuestion === questions.length - 1;
      byId("submitBtn").style.display = (currentQuestion === questions.length - 1) ? "inline-block" : "none";
    }

    function selectAnswer(idx){
      userAnswers[currentQuestion] = idx;
      const labels = document.querySelectorAll(".choices label");
      labels.forEach((lbl,i)=> lbl.classList.toggle("selected", i===idx));
    }
    window.selectAnswer = selectAnswer;

    function nextQuestion(){
      if(currentQuestion < questions.length - 1){
        currentQuestion++;
        renderQuestion();
      }
    }
    function prevQuestion(){
      if(currentQuestion > 0){
        currentQuestion--;
        renderQuestion();
      }
    }
    window.nextQuestion = nextQuestion;
    window.prevQuestion = prevQuestion;

    function submitQuiz(){
      let score = 0;
      for(let i=0;i<questions.length;i++){
        if(userAnswers[i] === questions[i].answer) score++;
      }
      hasSubmitted = true;
      lastScore = score;

      const entry = leaderboard[userName] || {best:0,last:0,attempts:0,rank:0,delta:0,rankMove:0};
      const prevLast = Number(entry.last||0);
      const delta = entry.attempts ? (score - prevLast) : 0;

      entry.best = Math.max(Number(entry.best||0), score);
      entry.last = score;
      entry.attempts = Number(entry.attempts||0) + 1;
      entry.delta = delta;
      leaderboard[userName] = entry;

      const rows = computeSortedBoard();
      rows.forEach(r=>{
        if(!leaderboard[r.name]) return;
        leaderboard[r.name].rank = r.newRank;
        leaderboard[r.name].rankMove = r.rankMove;
      });

      saveBoard(leaderboard);
      updateTabAvailability();
      gotoTab("result");
    }
    window.submitQuiz = submitQuiz;

    function renderResults(){
      const area = byId("resultArea");
      if(!hasSubmitted){
        area.innerHTML = `<div class="panel">Submit the quiz to view your results.</div>`;
        return;
      }

      const passMark = Math.ceil(questions.length * 0.8);
      const passed = lastScore >= passMark;

      const entry = leaderboard[userName] || {};
      const delta = Number(entry.delta||0);
      const deltaTxt = delta===0 ? "0" : (delta>0 ? `+${delta}` : `${delta}`);

      const reviewItems = questions.map((q,i)=>{
        const userIdx = userAnswers[i];
        const userText = (userIdx===null || userIdx===undefined)
          ? "<i class='muted'>No answer</i>"
          : esc(q.choices[userIdx]);
        const correctText = esc(q.choices[q.answer]);
        const ok = userIdx === q.answer;

        return `
          <li>
            <b>Q${i+1}:</b>
            ${ok
              ? `<span class="good">${userText}</span>`
              : `<span class="bad">${userText}</span> <span class="muted">| Correct:</span> <span class="good">${correctText}</span>`
            }
          </li>
        `;
      }).join("");

      area.innerHTML = `
        <div class="result">
          <div><b>${esc(userName)}</b>, you scored <span class="good">${lastScore}</span> / ${questions.length}.</div>
          <div class="muted" style="margin-top:6px;">
            Status: ${passed ? `<span class="good">PASS</span>` : `<span class="bad">FAIL</span>`}
            &nbsp;|&nbsp; Best: <span class="good">${Number(entry.best||lastScore)}</span>
            &nbsp;|&nbsp; Change vs last attempt: <b>${deltaTxt}</b>
          </div>
          <div class="row-actions">
            <button onclick="retakeQuiz()">Retake Quiz</button>
            <button onclick="gotoTab('answers')">Correct Answers Tab</button>
            <button onclick="gotoTab('leaderboard')">Leaderboard Tab</button>
          </div>
        </div>

        <div class="panel">
          <div style="font-weight:800;color:var(--red);margin-bottom:8px;">Per-question results</div>
          <ol class="list">${reviewItems}</ol>
        </div>
      `;
    }

    function renderCorrectAnswers(){
      const area = byId("answersArea");
      const items = questions.map((q,i)=>{
        return `<li><b>Q${i+1}:</b> <span class="good">${esc(q.choices[q.answer])}</span></li>`;
      }).join("");

      area.innerHTML = `
        <div class="panel">
          <div style="font-weight:800;color:var(--red);margin-bottom:8px;">All Correct Answers</div>
          <ol class="list">${items}</ol>
        </div>
      `;
    }

    function renderLeaderboard(){
      const area = byId("leaderboardArea");
      const rows = computeSortedBoard();

      if(!rows.length){
        area.innerHTML = `<div class="panel">No scores yet. Take the quiz to appear on the leaderboard.</div>`;
        return;
      }

      const rowHtml = rows.map(r=>{
        const v = leaderboard[r.name] || {};
        const delta = Number(v.delta||0);
        const deltaTxt = delta===0 ? "0" : (delta>0 ? `+${delta}` : `${delta}`);

        const move = Number(v.rankMove||0);
        const moveTxt = move===0 ? "–" : (move>0 ? `▲ ${move}` : `▼ ${Math.abs(move)}`);

        return `
          <li>
            <b>#${r.newRank}</b> ${esc(r.name)}
            <span class="muted">| Best:</span> <span class="good">${r.best}</span>
            <span class="muted">| Last:</span> <span class="good">${r.last}</span>
            <span class="muted">| Attempts:</span> ${r.attempts}
            <span class="muted">| Change:</span> <b>${deltaTxt}</b>
            <span class="muted">| Rank:</span> <b>${moveTxt}</b>
          </li>
        `;
      }).join("");

      area.innerHTML = `
        <div class="panel">
          <div class="muted" style="margin-bottom:6px;">
            Saved in this browser (localStorage). Clearing site data resets it.
          </div>
          <div style="font-weight:800;color:var(--red);margin-bottom:8px;">Leaderboard</div>
          <ol class="list">${rowHtml}</ol>
          <div class="row-actions">
            <button onclick="resetLeaderboard()">Reset Leaderboard</button>
          </div>
        </div>
      `;
    }

    function retakeQuiz(){
      currentQuestion = 0;
      userAnswers = Array(questions.length).fill(null);
      hasSubmitted = false;
      lastScore = 0;
      updateTabAvailability();
      gotoTab("quiz");
    }
    window.retakeQuiz = retakeQuiz;

    function resetLeaderboard(){
      if(!confirm("Reset leaderboard for this browser?")) return;
      leaderboard = {};
      saveBoard(leaderboard);
      renderLeaderboard();
    }
    window.resetLeaderboard = resetLeaderboard;

    window.onload = function(){
      try {
        renderWelcome();
      } catch (e) {
        console.error(e);
        showFatal(e);
      }
    };
  </script>
</body>
</html>